{% extends 'index_base.html' %}

{% block head %}
<div style="margin-top: 50px">
    <h4 style="color: whitesmoke" class="text-center">如未注册，请注册用户
        <a href="/index/register/" style="margin-top: 10px" class="btn btn-warning btn-lg">
            <i style="margin-right: 10px;font-size: 16px" class="fa fa-pencil-square-o" aria-hidden="true">
                注册
            </i>
        </a>
    </h4>
</div>
{% endblock %}

{% block content %}

{#<h4 style="color: whitesmoke">填写以下信息，完成登录：</h4>#}
{#<form action="/index/api/login/" method="post">#}
{#  <div class="form-group" id="user_form">#}
{#    <input type="text" class="form-control" name="username" placeholder="用户名">#}
{#  </div>#}
{#  <div class="form-group" id="password_form">#}
{#    <input required="required" type="password" class="form-control" name="password" placeholder="密码">#}
{#  </div>#}
{#  <button id="login" style="font-size: 20px" class="btn btn-success form-control">登录</button>#}
{#</form>#}

<div style="position:relative;">
    <img src="/static/img/login_Centerleft.jpg" alt="">
    <form class="login_form" style="position: absolute;left: 150px;top: 30px;">
        {% if info %}
            <div class="alert alert-warning">{{ info }}</div>
        {% endif %}
        {% csrf_token %}
        <h3 style="color: black">欢迎登录<i style="float: right" class="text-center"></i></h3>
        <div class="form-group" id="user_form">
            <input type="text" class="form-control" name="username" placeholder="用户名">
        </div>
        <div class="form-group" id="password_form">
            <input required="required" type="password" class="form-control" name="password" placeholder="密码">
        </div>
        <button type="reset" id="reset" style="font-size: 16px;color: black" class="btn btn-default pull-left">重置</button>
        <button type="submit" id="login" style="font-size: 16px;color: black" class="btn btn-primary pull-right" onclick="keyLogin()">登录</button>
    </form>
</div>
{#<form>#}
{#  <div class="form-group" id="user_form">#}
{#    <input type="text" class="form-control" name="username" placeholder="用户名">#}
{#  </div>#}
{#  <div class="form-group" id="password_form">#}
{#    <input required="required" type="password" class="form-control" name="password" placeholder="密码">#}
{#  </div>#}
{#  <a id="login" style="font-size: 20px" class="btn btn-success form-control">登录</a>#}
{#</form>#}

<script type="text/javascript">

      $("#login").click(function () {
          var username = $("input[name='username']").val();
          var password = $("input[name='password']").val();
          $.post('/index/api/login/', {username:username, password:password}, function (data) {
                if(data.flag == true){
                    alert(username+"登录成功");
                    window.location.href = '/index/home/'
                }else if(data.flag == false) {
                    alert(data.info);
                }
          });
      });
      function keyLogin(){
           if (event.keyCode==13){  //回车键的键值为13
                alert("回车！");
                $("#login").submit();
                //document.getElementById("loginForm").click(); //调用登录按钮的登录事件
            }
        }

{#    $("#login").click(function () {#}
{#        $("#user_form").removeClass("has-error");#}
{#        $("#user_form").removeClass("has-success");#}
{#        $("#helpBlock1").remove();#}
{#        var a = $("input[name='username']").val();#}
{#        if(a == ""){#}
{#            alert("用户名不能为空");#}
{#            $("#user_form").addClass("has-error");#}
{#            $("#user_form").append("<span id=\"helpBlock1\" class=\"help-block\">用户名不能为空</span>")#}
{#        }else {#}
{#            $("#user_form").addClass("has-success");#}
{#        }#}
{##}
{#    });#}

</script>
{% endblock %}